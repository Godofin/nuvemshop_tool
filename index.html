<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ferramentas Nuvemshop - Excurs√µes & Imagens</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        /* Estilo personalizado para o scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }

        /* Utilit√°rios de transi√ß√£o e tabs */
        .tool-section { display: none; animation: fadeIn 0.3s ease-in-out; }
        .tool-section.active { display: block; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .nav-tab.active {
            border-bottom: 3px solid #2563eb;
            color: #1e40af;
            background-color: #eff6ff;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">

    <!-- MENU DE NAVEGA√á√ÉO (ABAS) -->
    <div class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex space-x-1">
                <button onclick="switchTool('generator')" id="nav-generator" class="nav-tab active flex items-center py-4 px-6 font-semibold text-gray-600 hover:text-blue-600 transition-colors w-full md:w-auto justify-center border-b-3 border-transparent">
                    <i class="fa-solid fa-bus mr-2"></i> Gerador de Excurs√£o
                </button>
                <button onclick="switchTool('resizer')" id="nav-resizer" class="nav-tab flex items-center py-4 px-6 font-semibold text-gray-600 hover:text-blue-600 transition-colors w-full md:w-auto justify-center border-b-3 border-transparent">
                    <i class="fa-solid fa-image mr-2"></i> Redimensionador Nuvemshop
                </button>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto p-6">
        
        <!-- ========================================== -->
        <!-- FERRAMENTA 1: GERADOR DE EXCURS√ÉO          -->
        <!-- ========================================== -->
        <div id="tool-generator" class="tool-section active">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                
                <!-- COLUNA DA ESQUERDA: FORMUL√ÅRIO -->
                <div class="bg-white p-6 rounded-lg shadow-lg h-fit">
                    <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2">Dados do Evento</h2>
                    <form id="generatorForm" class="space-y-4">
                        <!-- Linha 1 -->
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Nome do Artista/Banda</label>
                                <input type="text" id="artist" class="mt-1 block w-full border border-gray-300 rounded-md p-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Ex: Iron Maiden" oninput="updateAll()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Nome da Turn√™ (Opcional)</label>
                                <input type="text" id="tourName" class="mt-1 block w-full border border-gray-300 rounded-md p-2" placeholder="Ex: The Future Past Tour" oninput="updateAll()">
                            </div>
                        </div>
                        <!-- Linha 2 -->
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Data do Show</label>
                                <input type="text" id="date" class="mt-1 block w-full border border-gray-300 rounded-md p-2" placeholder="Ex: 15 de Mar√ßo de 2026" oninput="updateAll()">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Local (Venue)</label>
                                <input type="text" id="venue" class="mt-1 block w-full border border-gray-300 rounded-md p-2" placeholder="Ex: Allianz Parque, SP" oninput="updateAll()">
                            </div>
                        </div>
                        <!-- Cidades -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Cidades de Embarque (Uma por linha)</label>
                            <textarea id="cities" rows="4" class="mt-1 block w-full border border-gray-300 rounded-md p-2" placeholder="Araraquara&#10;S√£o Carlos&#10;Limeira" oninput="updateAll()"></textarea>
                        </div>
                        <!-- Status -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Status Especial</label>
                            <select id="status" class="mt-1 block w-full border border-gray-300 rounded-md p-2" onchange="updateAll()">
                                <option value="normal">Normal</option>
                                <option value="soldout">Ingressos Esgotados (Sold Out)</option>
                                <option value="newdate">Nova Data Extra</option>
                                <option value="lastseats">√öltimas Vagas</option>
                            </select>
                        </div>
                        <!-- Descri√ß√£o -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Texto Descritivo (Copy)</label>
                            <textarea id="description" rows="5" class="mt-1 block w-full border border-gray-300 rounded-md p-2" placeholder="Cole o texto sobre a banda aqui..." oninput="updateAll()"></textarea>
                        </div>
                        <!-- Extras -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Inclus√µes (Separadas por v√≠rgula)</label>
                            <input type="text" id="inclusions" class="mt-1 block w-full border border-gray-300 rounded-md p-2" value="Transporte executivo ida e volta, Seguro viagem, Monitores da ag√™ncia, Servi√ßo de bordo na ida" oninput="updateAll()">
                        </div>
                    </form>
                </div>

                <!-- COLUNA DA DIREITA: PREVIEW E C√ìDIGO -->
                <div class="flex flex-col gap-6">
                    <!-- PREVIEW VISUAL -->
                    <div class="bg-white p-4 rounded-lg shadow-lg border border-gray-200">
                        <h3 class="text-xs font-bold text-gray-400 uppercase mb-2">Visualiza√ß√£o (Como fica na loja)</h3>
                        <div id="previewArea" class="border p-4 rounded bg-white min-h-[300px]">
                            <!-- O conte√∫do ser√° injetado aqui -->
                        </div>
                    </div>

                    <!-- C√ìDIGOS GERADOS -->
                    <div class="bg-gray-800 p-6 rounded-lg shadow-lg text-white">
                        <div class="flex border-b border-gray-600 mb-4">
                            <button onclick="switchCodeTab('html')" id="btn-html" class="tab-btn py-2 px-4 text-blue-400 border-b-2 border-blue-400 font-bold">HTML (Descri√ß√£o)</button>
                            <button onclick="switchCodeTab('seo')" id="btn-seo" class="tab-btn py-2 px-4 text-gray-400 hover:text-white">SEO & Tags</button>
                        </div>

                        <!-- Conte√∫do HTML -->
                        <div id="tab-html" class="tab-content">
                            <label class="text-xs text-gray-400 uppercase">Copie e cole no c√≥digo-fonte &lt; &gt;</label>
                            <div class="relative mt-1">
                                <textarea id="codeOutput" readonly class="w-full h-48 bg-gray-900 text-green-400 font-mono text-xs p-3 rounded border border-gray-700 focus:outline-none"></textarea>
                                <button onclick="copyToClipboard('codeOutput')" class="absolute top-2 right-2 bg-blue-600 hover:bg-blue-700 text-white text-xs px-3 py-1 rounded transition">Copiar</button>
                            </div>
                        </div>

                        <!-- Conte√∫do SEO -->
                        <div id="tab-seo" class="tab-content hidden space-y-4">
                            <div>
                                <label class="text-xs text-gray-400 uppercase font-bold">T√≠tulo SEO</label>
                                <div class="relative">
                                    <input type="text" id="seoTitle" readonly class="w-full bg-gray-900 text-white text-sm p-2 rounded border border-gray-700">
                                    <button onclick="copyToClipboard('seoTitle')" class="absolute top-1 right-1 bg-gray-700 hover:bg-gray-600 text-white text-xs px-2 py-1 rounded">Copiar</button>
                                </div>
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 uppercase font-bold">Meta Description</label>
                                <div class="relative">
                                    <textarea id="seoDesc" readonly rows="2" class="w-full bg-gray-900 text-white text-sm p-2 rounded border border-gray-700"></textarea>
                                    <button onclick="copyToClipboard('seoDesc')" class="absolute top-2 right-2 bg-gray-700 hover:bg-gray-600 text-white text-xs px-2 py-1 rounded">Copiar</button>
                                </div>
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 uppercase font-bold">Tags/Palavras-chave</label>
                                <div class="relative">
                                    <textarea id="seoTags" readonly rows="3" class="w-full bg-gray-900 text-white text-sm p-2 rounded border border-gray-700"></textarea>
                                    <button onclick="copyToClipboard('seoTags')" class="absolute top-2 right-2 bg-gray-700 hover:bg-gray-600 text-white text-xs px-2 py-1 rounded">Copiar</button>
                                </div>
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 uppercase font-bold">URL do Produto (Slug)</label>
                                <div class="relative">
                                    <input type="text" id="seoSlug" readonly class="w-full bg-gray-900 text-white text-sm p-2 rounded border border-gray-700">
                                    <button onclick="copyToClipboard('seoSlug')" class="absolute top-1 right-1 bg-gray-700 hover:bg-gray-600 text-white text-xs px-2 py-1 rounded">Copiar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ========================================== -->
        <!-- FERRAMENTA 2: REDIMENSIONADOR DE IMAGENS   -->
        <!-- ========================================== -->
        <div id="tool-resizer" class="tool-section">
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                
                <!-- COLUNA DA ESQUERDA: CONTROLES -->
                <div class="lg:col-span-4 bg-white p-6 rounded-lg shadow-lg h-fit">
                    <h2 class="text-xl font-bold mb-6 text-gray-800 border-b pb-2">Configura√ß√£o</h2>
                    
                    <div class="space-y-6">
                        <!-- Input de Arquivo -->
                        <div>
                            <label for="imageInput" class="block text-sm font-medium text-gray-700 mb-2">1. Carregar Imagem</label>
                            <input type="file" id="imageInput" accept="image/*" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 cursor-pointer">
                        </div>

                        <!-- Seletor de Presets (NOVIDADE) -->
                        <div>
                            <label for="presetSelect" class="block text-sm font-medium text-gray-700 mb-2">2. Escolher Formato (Nuvemshop)</label>
                            <select id="presetSelect" class="w-full p-2 border border-gray-300 rounded-md bg-gray-50 focus:ring-blue-500 focus:border-blue-500 text-gray-800">
                                <option value="custom">‚úèÔ∏è Personalizado (Manual)</option>
                                <option value="1580,450">üíª Banner Rotativo (1580 x 450 px)</option>
                                <option value="1024,1024">üëï Imagem do Produto (1024 x 1024 px)</option>
                                <option value="620,715">üè∑Ô∏è Banner Promocional/Categoria (620 x 715 px)</option>
                                <option value="300,200">üè¢ Marcas (300 x 200 px)</option>
                            </select>
                        </div>

                        <!-- Inputs Manuais -->
                        <div class="grid grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg border border-gray-200">
                            <div>
                                <label for="widthInput" class="block text-xs font-bold text-gray-500 uppercase mb-1">Largura (px)</label>
                                <input type="number" id="widthInput" placeholder="Ex: 800" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500">
                            </div>
                            <div>
                                <label for="heightInput" class="block text-xs font-bold text-gray-500 uppercase mb-1">Altura (px)</label>
                                <input type="number" id="heightInput" placeholder="Ex: 600" class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500">
                            </div>
                        </div>

                        <!-- Bot√£o -->
                        <button id="resizeButton" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg shadow hover:bg-blue-700 transition transform active:scale-95">
                            <i class="fa-solid fa-compress mr-2"></i> Redimensionar Agora
                        </button>

                        <!-- Erro -->
                        <div id="error-message" class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative text-sm">
                            <span id="error-message-text">Selecione uma imagem primeiro.</span>
                        </div>
                    </div>
                </div>

                <!-- COLUNA DA DIREITA: PREVIEW -->
                <div class="lg:col-span-8 space-y-6">
                    
                    <!-- Preview Original -->
                    <div id="originalContainer" class="hidden bg-white p-4 rounded-lg shadow border border-gray-200">
                        <h3 class="text-sm font-bold text-gray-500 uppercase mb-2">Original</h3>
                        <div class="bg-gray-100 rounded flex justify-center items-center p-2 overflow-hidden">
                            <img id="originalPreview" src="#" alt="Original" class="max-h-64 object-contain shadow-sm">
                        </div>
                    </div>

                    <!-- Preview Redimensionado -->
                    <div id="resizedContainer" class="hidden bg-green-50 p-6 rounded-lg shadow-lg border border-green-200 text-center">
                        <h3 class="text-lg font-bold text-green-800 mb-4">‚úÖ Resultado Gerado</h3>
                        
                        <div class="flex justify-center mb-6">
                            <img id="resizedPreview" src="#" alt="Redimensionada" class="max-h-[400px] w-auto object-contain shadow-lg border-4 border-white rounded">
                        </div>
                        
                        <a id="downloadLink" href="#" download="imagem-redimensionada.png" class="inline-block bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg shadow transition transform hover:-translate-y-1">
                            <i class="fa-solid fa-download mr-2"></i> Baixar Imagem
                        </a>
                    </div>

                </div>
            </div>
        </div>

    </div>

    <!-- SCRIPTS COMBINADOS -->
    <script>
        // ==========================================
        // NAVEGA√á√ÉO (ABAS)
        // ==========================================
        function switchTool(toolId) {
            // Remove active class from all sections and buttons
            document.querySelectorAll('.tool-section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(el => el.classList.remove('active'));

            // Add active class to selected
            document.getElementById(`tool-${toolId}`).classList.add('active');
            document.getElementById(`nav-${toolId}`).classList.add('active');
        }

        // ==========================================
        // L√ìGICA: GERADOR DE EXCURS√ÉO
        // ==========================================
        function updateAll() {
            const artist = document.getElementById('artist').value || 'Nome da Banda';
            const tourName = document.getElementById('tourName').value;
            const date = document.getElementById('date').value || 'Data a definir';
            const venue = document.getElementById('venue').value || 'Local a definir';
            const citiesText = document.getElementById('cities').value;
            const status = document.getElementById('status').value;
            const description = document.getElementById('description').value || 'Descri√ß√£o do evento...';
            const inclusionsText = document.getElementById('inclusions').value;

            // Process Cities
            const citiesArray = citiesText.split('\n').filter(city => city.trim() !== '');
            let citiesHtml = '';
            let citiesStringSEO = '';
            
            citiesArray.forEach(city => {
                citiesHtml += `<li style="padding: 8px 0; border-bottom: 1px solid #eee; font-size: 1.05em;">üìç <strong>${city}</strong></li>`;
                citiesStringSEO += `${city}, `;
            });
            citiesStringSEO = citiesStringSEO.slice(0, -2); 

            // Process Inclusions
            const inclusionsArray = inclusionsText.split(',').filter(item => item.trim() !== '');
            let inclusionsHtml = '';
            inclusionsArray.forEach(item => {
                inclusionsHtml += `<li>${item.trim()}.</li>`;
            });

            // Alert Box Logic
            let alertBox = '';
            if (status === 'soldout') {
                alertBox = `<div style="background-color: #222; color: #fff; padding: 15px; border-radius: 5px; margin-bottom: 20px; border-left: 5px solid #e30613;"><h3 style="margin-top: 0; color: #fff; font-size: 1.1em;">‚ö†Ô∏è Aten√ß√£o: Ingressos Esgotados</h3><p style="margin-bottom: 0; font-size: 0.95em;">O show est√° sold-out! Garanta agora seu transporte antes que as vagas no √¥nibus tamb√©m acabem.</p></div>`;
            } else if (status === 'newdate') {
                alertBox = `<div style="background-color: #f4f4f4; padding: 15px; border-radius: 5px; margin-bottom: 20px; border-left: 5px solid #28a745;"><h3 style="margin-top: 0; color: #000;">üìÖ Nova Data Extra!</h3><p style="margin-bottom: 0;">Devido √† alta demanda, abrimos excurs√£o para a data extra.</p></div>`;
            } else if (status === 'lastseats') {
                alertBox = `<div style="background-color: #fff3cd; color: #856404; padding: 15px; border-radius: 5px; margin-bottom: 20px; border: 1px solid #ffeeba;"><h3 style="margin-top: 0; font-size: 1.1em;">‚è≥ √öltimas Vagas</h3><p style="margin-bottom: 0;">Restam pouqu√≠ssimos lugares para esta excurs√£o.</p></div>`;
            }

            const fullTitle = tourName ? `Excurs√£o ${artist}: ${tourName}` : `Excurs√£o ${artist}`;

            // HTML Template
            const htmlTemplate = `
<div style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; color: #333; line-height: 1.6;">
    <h2 style="color: #000; text-transform: uppercase; border-bottom: 3px solid #000; padding-bottom: 10px; margin-bottom: 20px;">${fullTitle}</h2>
    <p style="font-style: italic; color: #666;">[Imagem do P√¥ster do Show aqui]</p>
    ${alertBox}
    <div style="background-color: #f9f9f9; padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #eee;">
        <p style="margin: 0 0 8px 0;"><strong>üìÖ DATA:</strong> ${date}</p>
        <p style="margin: 0;"><strong>üèüÔ∏è LOCAL:</strong> ${venue}</p>
    </div>
    <div style="border: 1px solid #ddd; padding: 20px; border-radius: 8px; margin-bottom: 25px;">
        <h3 style="margin-top: 0; color: #004085; font-size: 1.2em;">üöå Cidades de Embarque</h3>
        <ul style="list-style: none; padding: 0; margin: 0;">${citiesHtml || '<li style="color:#999;">Nenhuma cidade inserida</li>'}</ul>
        <p style="font-size: 0.85em; color: #666; margin-top: 10px;">*Selecione sua cidade nas op√ß√µes do produto.</p>
    </div>
    <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">
    <h3 style="color: #000;">Sobre o Evento</h3>
    <div style="margin-bottom: 20px;">${description.replace(/\n/g, '<br>')}</div>
    <h4 style="color: #333;">O pacote inclui:</h4>
    <ul style="margin-bottom: 25px;">${inclusionsHtml}</ul>
    <div style="background-color: #000; color: #fff; padding: 15px; border-radius: 5px; text-align: center;">
        <p style="margin: 0; font-weight: bold; text-transform: uppercase;">Garanta seu lugar</p>
        <p style="margin: 5px 0 0 0; font-size: 0.8em;">Vagas limitadas. Compra 100% segura.</p>
    </div>
</div>`;

            document.getElementById('previewArea').innerHTML = htmlTemplate;
            document.getElementById('codeOutput').value = htmlTemplate.trim();

            // SEO
            const seoT = `Excurs√£o ${artist} ${new Date().getFullYear() + 1} - Sa√≠da ${citiesStringSEO}`;
            document.getElementById('seoTitle').value = seoT.substring(0, 70);
            const seoD = `Garanta seu transporte para o show do ${artist} no ${venue}. Excurs√£o com sa√≠da de ${citiesStringSEO}. Conforto e seguran√ßa. Reserve agora!`;
            document.getElementById('seoDesc').value = seoD.substring(0, 160);
            const tags = `Excurs√£o, Transporte, ${artist}, ${tourName}, ${venue}, Show, Rock, Viagem, ${citiesStringSEO.replace(/, /g, ', ')}`;
            document.getElementById('seoTags').value = tags;
            const slugBase = `excursao-${artist}-sp-${citiesStringSEO}`;
            const slug = slugBase.toLowerCase().replace(/ /g, '-').replace(/[^\w-]+/g, '').replace(/--+/g, '-');
            document.getElementById('seoSlug').value = slug;
        }

        function switchCodeTab(tab) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(`tab-${tab}`).classList.remove('hidden');
            document.querySelectorAll('.tab-btn').forEach(el => {
                el.classList.remove('text-blue-400', 'border-blue-400', 'font-bold');
                el.classList.add('text-gray-400');
            });
            document.getElementById(`btn-${tab}`).classList.add('text-blue-400', 'border-blue-400', 'font-bold');
            document.getElementById(`btn-${tab}`).classList.remove('text-gray-400');
        }

        function copyToClipboard(elementId) {
            const el = document.getElementById(elementId);
            el.select();
            document.execCommand('copy');
            const originalBg = el.style.backgroundColor;
            el.style.backgroundColor = '#d1fae5';
            setTimeout(() => el.style.backgroundColor = originalBg, 200);
        }

        // ==========================================
        // L√ìGICA: REDIMENSIONADOR DE IMAGENS
        // ==========================================
        const imageInput = document.getElementById('imageInput');
        const widthInput = document.getElementById('widthInput');
        const heightInput = document.getElementById('heightInput');
        const presetSelect = document.getElementById('presetSelect');
        const resizeButton = document.getElementById('resizeButton');
        const originalContainer = document.getElementById('originalContainer');
        const originalPreview = document.getElementById('originalPreview');
        const resizedContainer = document.getElementById('resizedContainer');
        const resizedPreview = document.getElementById('resizedPreview');
        const downloadLink = document.getElementById('downloadLink');
        const errorMessage = document.getElementById('error-message');
        const errorMessageText = document.getElementById('error-message-text');
        let originalImageSrc = null;

        // Controle de Presets
        presetSelect.addEventListener('change', function() {
            const val = this.value;
            if (val === 'custom') {
                widthInput.value = '';
                heightInput.value = '';
                widthInput.focus();
            } else {
                const [w, h] = val.split(',');
                widthInput.value = w;
                heightInput.value = h;
            }
        });

        // Carregar Imagem
        imageInput.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    originalImageSrc = e.target.result;
                    originalPreview.src = originalImageSrc;
                    originalContainer.classList.remove('hidden');
                    resizedContainer.classList.add('hidden');
                    errorMessage.classList.add('hidden');
                };
                reader.readAsDataURL(file);
            }
        });

        // Redimensionar
        resizeButton.addEventListener('click', () => {
            const width = parseInt(widthInput.value, 10);
            const height = parseInt(heightInput.value, 10);

            if (!originalImageSrc) {
                errorMessageText.textContent = 'Por favor, carregue uma imagem primeiro.';
                errorMessage.classList.remove('hidden');
                return;
            }
            if (!width || !height) {
                errorMessageText.textContent = 'Insira a largura e a altura ou selecione um formato.';
                errorMessage.classList.remove('hidden');
                return;
            }
            
            errorMessage.classList.add('hidden');

            const img = new Image();
            img.src = originalImageSrc;

            img.onload = () => {
                const canvas = document.createElement('canvas');
                canvas.width = width;
                canvas.height = height;
                const ctx = canvas.getContext('2d');
                
                // Melhor qualidade
                ctx.imageSmoothingEnabled = true;
                ctx.imageSmoothingQuality = 'high';
                
                ctx.drawImage(img, 0, 0, width, height);

                const resizedDataUrl = canvas.toDataURL('image/png');
                resizedPreview.src = resizedDataUrl;
                resizedContainer.classList.remove('hidden');
                downloadLink.href = resizedDataUrl;
                
                const originalFileName = imageInput.files[0] ? imageInput.files[0].name : 'imagem';
                const fileNameSemExtensao = originalFileName.split('.').slice(0, -1).join('.');
                downloadLink.download = `${fileNameSemExtensao}_${width}x${height}.png`;
            };

            img.onerror = () => {
                errorMessageText.textContent = 'Erro ao processar a imagem.';
                errorMessage.classList.remove('hidden');
            };
        });

        // Inicializa o gerador
        updateAll();
    </script>
</body>
</html>
